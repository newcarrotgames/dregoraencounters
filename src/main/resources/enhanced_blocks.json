{
  "version": "2.0",
  "defaults": {
    "encounterCooldownSeconds": 900,
    "maxActivePerChunk": 1,
    "maxActiveGlobal": 32
  },
  "globalVariables": {
    "baseArmySize": "8",
    "maxArmySize": "25",
    "difficultyScaling": "Math.max(1, Math.min(difficulty * 4, 6))",
    "eliteThreshold": "3.0",
    "nightTimeBonus": "isNight ? 1.5 : 1.0"
  },
  "presets": {
    "enchantmentPools": {
      "basic_weapon_enchants": {
        "minEnchants": 0,
        "maxEnchants": "Math.max(1, Math.floor(difficulty / 2))",
        "levelBonus": "0",
        "options": [
          {"id": "sharpness", "level": "Math.min(2, Math.floor(difficulty))", "weight": 3},
          {"id": "knockback", "level": "1", "weight": 2},
          {"id": "fire_aspect", "level": "1", "weight": 1, "condition": "difficulty >= 2"}
        ]
      },
      "elite_weapon_enchants": {
        "minEnchants": 1,
        "maxEnchants": "3",
        "levelBonus": "Math.floor(difficulty)",
        "options": [
          {"id": "sharpness", "level": "Math.min(3, 1 + Math.floor(difficulty))", "weight": 4},
          {"id": "knockback", "level": "2", "weight": 2},
          {"id": "fire_aspect", "level": "1", "weight": 2},
          {"id": "looting", "level": "Math.min(2, Math.floor(difficulty / 2))", "weight": 1}
        ]
      },
      "basic_bow_enchants": {
        "minEnchants": 0,
        "maxEnchants": "2",
        "options": [
          {"id": "power", "level": "Math.min(3, 1 + Math.floor(difficulty / 2))", "weight": 4},
          {"id": "punch", "level": "1", "weight": 2},
          {"id": "flame", "level": "1", "weight": 1, "condition": "difficulty >= 2"}
        ]
      },
      "elite_bow_enchants": {
        "minEnchants": 1,
        "maxEnchants": "3",
        "options": [
          {"id": "power", "level": "Math.min(4, 2 + Math.floor(difficulty / 2))", "weight": 5},
          {"id": "punch", "level": "2", "weight": 3},
          {"id": "flame", "level": "1", "weight": 2},
          {"id": "infinity", "level": "1", "weight": 1, "condition": "difficulty >= 4"}
        ]
      },
      "basic_armor_enchants": {
        "minEnchants": 0,
        "maxEnchants": "2",
        "options": [
          {"id": "protection", "level": "Math.min(2, Math.floor(difficulty))", "weight": 4},
          {"id": "unbreaking", "level": "Math.min(2, Math.floor(difficulty / 2))", "weight": 2}
        ]
      },
      "elite_armor_enchants": {
        "minEnchants": 1,
        "maxEnchants": "3",
        "options": [
          {"id": "protection", "level": "Math.min(3, 1 + Math.floor(difficulty))", "weight": 5},
          {"id": "unbreaking", "level": "Math.min(3, Math.floor(difficulty))", "weight": 3},
          {"id": "thorns", "level": "1", "weight": 1, "condition": "difficulty >= 3"}
        ]
      }
    },
    "entityPresets": {
      "skeleton_commander": {
        "type": "entity",
        "entityId": "minecraft:skeleton",
        "count": 1,
        "persistence": true,
        "customName": "\u00A76\u00A7lSkeleton Commander",
        "showNameTag": true,
        "attributes": {
          "health": {"multiply": "1.8 + (difficulty * 0.2)"},
          "followRange": {"set": "24.0"},
          "attackDamage": {"multiply": "1.3 + (difficulty * 0.1)"}
        },
        "enhancedEquipment": {
          "mainhand": {
            "item": "minecraft:diamond_sword",
            "enchantments": [{"id": "sharpness", "level": "2 + Math.floor(difficulty)"}],
            "randomEnchants": "elite_weapon_enchants"
          },
          "helmet": {
            "item": "minecraft:diamond_helmet", 
            "randomEnchants": "elite_armor_enchants"
          },
          "chest": {
            "item": "minecraft:diamond_chestplate",
            "randomEnchants": "elite_armor_enchants" 
          },
          "legs": {
            "item": "minecraft:diamond_leggings",
            "randomEnchants": "elite_armor_enchants"
          },
          "boots": {
            "item": "minecraft:diamond_boots",
            "randomEnchants": "elite_armor_enchants"
          }
        },
        "aiToggles": {
          "clearTargetTasks": true,
          "canPickUpLoot": false,
          "followRange": 24.0
        }
      },
      "skeleton_cavalry": {
        "type": "entity",
        "entityId": "minecraft:skeleton",
        "count": 1,
        "persistence": true,
        "customName": "\u00A7aSkeleton Cavalry",
        "showNameTag": true,
        "attributes": {
          "health": {"multiply": "1.5 + (difficulty * 0.15)"},
          "followRange": {"set": "20.0"}
        },
        "enhancedEquipment": {
          "mainhand": {
            "item": "minecraft:bow",
            "randomEnchants": "elite_bow_enchants"
          },
          "helmet": {"item": "minecraft:iron_helmet", "randomEnchants": "basic_armor_enchants"},
          "chest": {"item": "minecraft:iron_chestplate", "randomEnchants": "basic_armor_enchants"},
          "legs": {"item": "minecraft:iron_leggings", "randomEnchants": "basic_armor_enchants"},
          "boots": {"item": "minecraft:iron_boots", "randomEnchants": "basic_armor_enchants"}
        }
      },
      "skeleton_horse_mount": {
        "type": "entity",
        "entityId": "minecraft:skeleton_horse",
        "count": 1,
        "persistence": true,
        "attributes": {
          "health": {"multiply": "1.2"},
          "movementSpeed": {"multiply": "1.1"}
        },
        "nbt": {
          "Tame": 1,
          "SaddleItem": {"id": "minecraft:saddle", "Count": 1}
        },
        "aiToggles": {
          "clearTargetTasks": true
        }
      },
      "skeleton_archer_elite": {
        "type": "entity",
        "entityId": "minecraft:skeleton", 
        "count": 1,
        "persistence": true,
        "customName": "\u00A7aSkeleton Marksman",
        "showNameTag": true,
        "attributes": {
          "health": {"multiply": "1.3 + (difficulty * 0.1)"},
          "followRange": {"set": "20.0"}
        },
        "enhancedEquipment": {
          "mainhand": {
            "item": "minecraft:bow",
            "randomEnchants": "basic_bow_enchants"
          },
          "offhand": {"item": "minecraft:arrow", "count": "32"},
          "helmet": {"item": "minecraft:leather_helmet"},
          "chest": {"item": "minecraft:leather_chestplate"}
        }
      },
      "skeleton_warrior_elite": {
        "type": "entity",
        "entityId": "minecraft:skeleton",
        "count": 1,
        "persistence": true,
        "customName": "\u00A7aSkeleton Warrior", 
        "showNameTag": true,
        "attributes": {
          "health": {"multiply": "1.6 + (difficulty * 0.2)"},
          "followRange": {"set": "16.0"},
          "attackDamage": {"multiply": "1.2"}
        },
        "enhancedEquipment": {
          "mainhand": {
            "item": "minecraft:iron_sword",
            "randomEnchants": "basic_weapon_enchants"
          },
          "offhand": {"item": "minecraft:shield"},
          "helmet": {"item": "minecraft:iron_helmet", "randomEnchants": "basic_armor_enchants"},
          "chest": {"item": "minecraft:iron_chestplate", "randomEnchants": "basic_armor_enchants"},
          "legs": {"item": "minecraft:iron_leggings", "randomEnchants": "basic_armor_enchants"}
        }
      },
      "skeleton_soldier_basic": {
        "type": "entity",
        "entityId": "minecraft:skeleton",
        "count": 1,
        "persistence": true,
        "customName": "\u00A7aSkeleton Soldier",
        "showNameTag": true,
        "attributes": {
          "health": {"multiply": "1.2 + (difficulty * 0.1)"}
        },
        "enhancedEquipment": {
          "mainhand": {"item": "minecraft:bow"},
          "chest": {"item": "minecraft:chainmail_chestplate"}
        }
      }
    }
  },
  "blocks": {
    "selectors": {
      "army_spawn_conditions": {
        "type": "enhancedSelector",
        "biomes": ["minecraft:roofed_forest", "minecraft:forest", "minecraft:plains"],
        "dimensions": [0],
        "timeOfDay": {"from": 13000, "to": 23000},
        "playerConstraints": {
          "minLevel": 5,
          "maxDistanceFromSpawn": 50000,
          "minOnlinePlayers": 1,
          "maxNearbyPlayers": 4
        },
        "cooldowns": {
          "perPlayerSeconds": 3600,
          "perChunkSeconds": 7200,
          "globalSeconds": 300
        },
        "weightExpression": "Math.max(1, difficulty * nightTimeBonus)",
        "customCondition": "difficulty >= 2.0 && !isRaining"
      }
    },
    "behaviors": {
      "friendly_guardian_enhanced": {
        "type": "friendlyGuardian",
        "targets": ["hostile", "!skeleton", "!player"],
        "excludeTargets": ["minecraft:skeleton"],
        "radiusExpression": "8 + Math.floor(difficulty * 2)",
        "speedExpression": "1.0 + (difficulty * 0.1)",
        "friendlyFire": false,
        "customAI": {
          "addHurtByTarget": "!instanceof EntityPlayer",
          "addNearestAttackableTarget": "EntityMob.class, !instanceof EntitySkeleton",
          "addAttackMelee": "melee_units_only",
          "addAttackRanged": "ranged_units_only"
        }
      }
    },
    "actions": {
      "army_arrival_announcement": {
        "type": "dynamicBroadcast",
        "scope": "nearbyPlayers",
        "radiusExpression": "32 + Math.floor(difficulty * 8)",
        "messageTemplate": {
          "template": "\u00A76\u00A7l{armyTitle} OF {armySize} WARRIORS ARRIVES!",
          "variables": {
            "armyTitle": "difficulty >= 4 ? 'THE ELITE LEGION' : 'THE SKELETON ARMY'",
            "armySize": "baseArmySize + Math.floor(difficultyScaling)"
          }
        }
      },
      "commander_battle_cry": {
        "type": "sayAboveHead",
        "target": "commander",
        "randomMessages": [
          "\u00A76FOR THE LIVING! CHARGE!",
          "\u00A76STAND FIRM! WE FIGHT AS ONE!",
          "\u00A76TODAY BONE AND FLESH UNITE!",
          "\u00A76LET ENEMIES TREMBLE BEFORE US!"
        ],
        "durationSeconds": 8
      },
      "army_supply_drop": {
        "type": "enhancedLootDrop",
        "to": "nearestPlayer",
        "condition": "difficulty >= 2",
        "loot": [
          {"item": "minecraft:arrow", "min": "32", "max": "32 + Math.floor(difficulty * 16)", "weight": 5},
          {"item": "minecraft:bone", "min": "8", "max": "8 + Math.floor(difficulty * 4)", "weight": 4},
          {"item": "minecraft:iron_ingot", "min": "5", "max": "5 + Math.floor(difficulty * 5)", "weight": 3},
          {"item": "minecraft:gold_ingot", "min": "3", "max": "3 + Math.floor(difficulty * 3)", "weight": 2},
          {"item": "minecraft:diamond", "min": "1", "max": "Math.floor(difficulty)", "weight": 1, "condition": "difficulty >= 3"},
          {"item": "minecraft:enchanted_book", "min": "1", "max": "1", "weight": 1, "condition": "difficulty >= 4"}
        ]
      }
    }
  }
}

